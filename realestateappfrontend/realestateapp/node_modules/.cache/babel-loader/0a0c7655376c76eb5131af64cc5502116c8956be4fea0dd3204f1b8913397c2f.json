{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kevin\\\\.vscode\\\\RealEstateAppBackup\\\\realestateappfrontend\\\\realestateapp\\\\src\\\\PayPalButtons_J.js\",\n  _s = $RefreshSig$();\nimport './PayPalButtons.css';\nimport { PayPalButtons } from \"@paypal/react-paypal-js\";\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport emailjs from '@emailjs/browser';\n\n//Declare base path for Paypal requests\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = 'http://localhost:5000/api';\n\n//Checkout component\nconst Checkout = ({\n  total,\n  cartProducts,\n  onPaymentSuccess\n}) => {\n  _s();\n  //Declare variables\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [error, setError] = useState(null);\n\n  //Create order function\n  const createOrder = async () => {\n    //Check if order total is greater than zero\n    if (Number(total) > 0) {\n      //Declare response from post request\n      const response = await axios.post(`${API_BASE_URL}/create-paypal-order`,\n      // Full URL\n      {\n        amount: total.toString()\n      });\n      return response.data.orderID; //Return OrderID from response\n    } else {\n      alert(\"カートは空です\");\n    }\n  };\n\n  //Declare on approve function\n  const onApprove = async data => {\n    try {\n      // Format cart dates to YYYY-MM-DD\n      const formattedCartProducts = cartProducts.map(product => {\n        const formatDate = isoStr => {\n          const date = new Date(isoStr);\n          const year = date.getFullYear();\n          const month = String(date.getMonth() + 1).padStart(2, '0');\n          const day = String(date.getDate()).padStart(2, '0');\n          return `${year}-${month}-${day}`;\n        };\n        return {\n          ...product,\n          reservationStartDate: formatDate(product.reservationStartDate),\n          reservationEndDate: formatDate(product.reservationEndDate)\n        };\n      });\n      const captureResponse = await axios.post(`${API_BASE_URL}/capture-paypal-order`, {\n        orderID: data.orderID,\n        cartProducts: formattedCartProducts\n      });\n      const orderDetails = captureResponse.data.orderDetails;\n\n      // Prepare template params for EmailJS\n      const templateParams = {\n        payer_name: orderDetails.payerName,\n        payer_email: orderDetails.payerEmail,\n        // Fixed typo: was emailEmail\n        orderID: orderDetails.paypalOrderId\n      };\n\n      // Send confirmation email\n      await emailjs.send('service_nq9jxwl', 'template_lvig8nl', templateParams, '5xgP6vguaJHGTQ-E4');\n      alert(\"支払いが完了しました！\");\n      onPaymentSuccess();\n      setError(null);\n    } catch (err) {\n      console.error(\"Capture error:\", err);\n      setError(\"An error occurred during payment processing.\");\n      throw err;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"checkout-container\",\n      children: [Number(total) === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cartmessage\",\n        children: \"\\u30AB\\u30FC\\u30C8\\u306F\\u7A7A\\u3067\\u3059\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 37\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(PayPalButtons, {\n        style: {\n          layout: \"vertical\"\n        },\n        createOrder: createOrder,\n        onApprove: onApprove,\n        onError: err => {\n          console.error(\"Paypal Error: \", err);\n        },\n        disabled: isProcessing\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 9\n    }, this)\n  }, void 0, false);\n};\n_s(Checkout, \"W5yHfJJxnjPVO+6REkksNaWV+SM=\");\n_c = Checkout;\nexport default Checkout;\nvar _c;\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["PayPalButtons","useState","useEffect","axios","emailjs","jsxDEV","_jsxDEV","Fragment","_Fragment","API_BASE_URL","Checkout","total","cartProducts","onPaymentSuccess","_s","isProcessing","setIsProcessing","error","setError","createOrder","Number","response","post","amount","toString","data","orderID","alert","onApprove","formattedCartProducts","map","product","formatDate","isoStr","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","reservationStartDate","reservationEndDate","captureResponse","orderDetails","templateParams","payer_name","payerName","payer_email","payerEmail","paypalOrderId","send","err","console","children","className","fileName","_jsxFileName","lineNumber","columnNumber","style","layout","onError","disabled","_c","$RefreshReg$"],"sources":["C:/Users/kevin/.vscode/RealEstateAppBackup/realestateappfrontend/realestateapp/src/PayPalButtons_J.js"],"sourcesContent":["import './PayPalButtons.css';\r\nimport { PayPalButtons } from \"@paypal/react-paypal-js\";\r\nimport { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport emailjs from '@emailjs/browser';\r\n\r\n//Declare base path for Paypal requests\r\nconst API_BASE_URL = 'http://localhost:5000/api';\r\n\r\n//Checkout component\r\nconst Checkout = ({total, cartProducts, onPaymentSuccess}) => {\r\n\r\n    //Declare variables\r\n    const [isProcessing, setIsProcessing] = useState(false);\r\n    const [error, setError] = useState(null);\r\n\r\n    //Create order function\r\n    const createOrder = async () => {\r\n        //Check if order total is greater than zero\r\n        if (Number(total) > 0) {\r\n\r\n            //Declare response from post request\r\n            const response = await axios.post(\r\n                `${API_BASE_URL}/create-paypal-order`, // Full URL\r\n                { amount: total.toString() }\r\n            );\r\n\r\n            return response.data.orderID; //Return OrderID from response\r\n        } else {\r\n            alert(\"カートは空です\");\r\n        }\r\n    };\r\n\r\n\r\n    //Declare on approve function\r\n    const onApprove = async (data) => {\r\n        try {\r\n            // Format cart dates to YYYY-MM-DD\r\n            const formattedCartProducts = cartProducts.map(product => {\r\n                const formatDate = (isoStr) => {\r\n                    const date = new Date(isoStr);\r\n                    const year = date.getFullYear();\r\n                    const month = String(date.getMonth() + 1).padStart(2, '0');\r\n                    const day = String(date.getDate()).padStart(2, '0');\r\n                    return `${year}-${month}-${day}`;\r\n                };\r\n\r\n                return {\r\n                    ...product,\r\n                    reservationStartDate: formatDate(product.reservationStartDate),\r\n                    reservationEndDate: formatDate(product.reservationEndDate)\r\n                };\r\n            });\r\n\r\n        const captureResponse = await axios.post(\r\n            `${API_BASE_URL}/capture-paypal-order`,\r\n            {\r\n                orderID: data.orderID,\r\n                cartProducts: formattedCartProducts\r\n            }\r\n        );\r\n\r\n        const orderDetails = captureResponse.data.orderDetails;\r\n\r\n        // Prepare template params for EmailJS\r\n        const templateParams = {\r\n            payer_name: orderDetails.payerName,\r\n            payer_email: orderDetails.payerEmail, // Fixed typo: was emailEmail\r\n            orderID: orderDetails.paypalOrderId\r\n        };\r\n\r\n        // Send confirmation email\r\n        await emailjs.send(\r\n            'service_nq9jxwl',\r\n            'template_lvig8nl',\r\n            templateParams,\r\n            '5xgP6vguaJHGTQ-E4'\r\n        );\r\n\r\n        alert(\"支払いが完了しました！\");\r\n        onPaymentSuccess();\r\n        setError(null);\r\n    } catch (err) {\r\n        console.error(\"Capture error:\", err);\r\n        setError(\"An error occurred during payment processing.\");\r\n        throw err;\r\n    }\r\n    };\r\n\r\n\r\n    return (\r\n        <>\r\n        <div className=\"checkout-container\">\r\n            {Number(total) === 0 && <div className=\"cartmessage\">カートは空です</div>}\r\n            <br/>\r\n            <br/>\r\n            <PayPalButtons\r\n                style={{ layout: \"vertical\" }}\r\n                createOrder = {createOrder}\r\n                onApprove = {onApprove}\r\n                onError={(err) => { console.error(\"Paypal Error: \", err);\r\n                }}\r\n\r\n                disabled={isProcessing}\r\n            />\r\n        </div>\r\n     </>\r\n    );\r\n};\r\n\r\nexport default Checkout;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}